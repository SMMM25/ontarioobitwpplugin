# Ontario Obituaries â€” Plugin directory security
# v3.17.0: Prevent directory listing and direct PHP access

# Disable directory browsing
Options -Indexes

# Block direct access to PHP files except the main plugin file
# Uses both Apache 2.2 and 2.4 syntax for maximum compatibility with LiteSpeed
<Files *.php>
    # Apache 2.4+
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    # Apache 2.2 / LiteSpeed fallback
    <IfModule !mod_authz_core.c>
        Order Deny,Allow
        Deny from all
    </IfModule>
</Files>

# Allow the main plugin file (loaded by WordPress)
<Files "ontario-obituaries.php">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order Allow,Deny
        Allow from all
    </IfModule>
</Files>

# Allow uninstall.php (used by WordPress during uninstall)
<Files "uninstall.php">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order Allow,Deny
        Allow from all
    </IfModule>
</Files>
